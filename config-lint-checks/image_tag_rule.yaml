version: 1
description: Rules for Kubernetes spec files
type: Kubernetes
files:
  - "*.yaml"
rules:
  - id: DEPLOYMENT_IMAGE_TAG
    severity: FAILURE
    message: Deployment must use a valid image tag
    resource: Deployment
    assertions:
      - every:
          key: spec.template.spec.containers
          expressions:            
            - key: image
              op: contains
              value: "my-company/my-app:"
    tags:
      - deployment
